async function fetchNewVisit(t){try{let e=await fetch("https://swiftoapi-b2njeivg2a-as.a.run.app/new_visit",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({swifto_id:t})});if(!e.ok)throw Error(`New Visit API request failed with status: ${e.status}`);let a=await e.json(),n=new Map;a.forEach(t=>{n.set(t.original,t.variant)}),updateElements(n),setTimeout(()=>{fetchEngaged(t,a)},1e4)}catch(i){console.error("Error:",i)}}function updateElements(t){let e=document.createTreeWalker(document.body,NodeFilter.SHOW_TEXT,null,!1);for(;e.nextNode();){let a=e.currentNode,n=a.nodeValue;t.forEach((t,e)=>{let a=RegExp(e,"g");n=n.replace(a,t)}),n!==a.nodeValue&&(a.nodeValue=n)}}async function fetchEngaged(t,e){try{let a=await fetch("https://swiftoapi-b2njeivg2a-as.a.run.app/engaged",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({swifto_id:t,text_and_variant_id:e})});if(!a.ok)throw Error(`Engaged API request failed with status: ${a.status}`);console.log("Engaged successfully.")}catch(n){console.error("Error:",n)}}document.addEventListener("DOMContentLoaded",function(){var t=window.SWIFTO_ID;console.log(t),fetchNewVisit(t)});
